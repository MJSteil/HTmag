//
// Created by M. J. Steil on 2017.05.12.
//

#ifndef HTMAG_TVII_O11_SERIES_HPP
#define HTMAG_TVII_O11_SERIES_HPP

#include <gsl/gsl_poly.h>

#include "Static_Star.hpp"


class TVII_O11_Series {
public:
    TVII_O11_Series(Static_Star* tvii_in, int mu_in=0, int print = 1);

    Static_Star *tvii;

    double *Z, *M, *R;
    int muI;

    double J0(int order);
    double omegabar0c(int order);

    double mu0(int order);
    double B0(int order);
    double BR(int order);

    double Qe00(int order);

private:

    double wI[4][21] = {
            {0.E0,2.857142857142857E-1,3.232323232323233E-1,4.622171479314336E-1,7.314828438225165E-1,1.225839569574151E0,2.131298645271222E0,3.801428420330047E0,6.907938468430205E0,1.273130997394607E1,2.372123040641279E1,4.457835819318896E1,8.43438643711095E1,1.604359968295479E2,3.064428840160995E2,5.871444860733713E2,1.127397742705084E3,2.167473022837024E3,4.168511324177577E3,8.01205677134336E3,1.537388484802487E4},
            {0.E0,3.376623376623376E-1,3.4331508711674E-1,4.47860879416101E-1,6.521252242410988E-1,1.011421858911153E0,1.634623946044566E0,2.719575646543821E0,4.622997989785178E0,7.98956805632148E0,1.398888246202219E1,2.475085359889261E1,4.416693615329269E1,7.936641436982667E1,1.434386198566612E2,2.604537197185873E2,4.74719348400852E2,8.67828431152772E2,1.589997679649547E3,2.91751590765373E3,5.357644340199894E3},
            {0.E0,3.673469387755102E-1,3.464381423565097E-1,4.294570901817883E-1,6.01482880777904E-1,9.04087831493139E-1,1.423441176585947E0,2.315971808619843E0,3.861524277655106E0,6.561490562430931E0,1.13180835539876E1,1.976211527284329E1,3.485367659046883E1,6.198542103007194E1,1.110129245557657E2,1.999969525318421E2,3.621090322019355E2,6.583837739811929E2,1.20127568943518E3,2.19816852841717E3,4.031685224908154E3},
            {0.E0,3.865546218487395E-1,3.452218677132172E-1,4.148840617218972E-1,5.691183798916675E-1,8.42607472816153E-1,1.311412976236755E0,2.114344840519137E0,3.499521811866804E0,5.910704651098832E0,1.014502480980821E1,1.764127753042614E1,3.100819907176818E1,5.499506628381377E1,9.82792452776933E1,1.767651357419699E2,3.196830152754164E2,5.808800408050304E2,1.059746278162015E3,1.940026703687998E3,3.561835909478904E3}
    };


    double womegabar0c[4][21] ={
            {1.E0,-2.5E0,-2.529761904761905E-1,-1.757756132756133E-1,-1.280935293212079E-1,-4.054248732091087E-2,1.774267414823628E-1,7.206168096723264E-1,2.034875551621947E0,5.147471853793373E0,1.242791830429944E1,2.93499247082176E1,6.858819617030886E1,1.595813045458954E2,3.709407295962148E2,8.63164634720001E2,2.013101370194941E3,4.708874318873425E3,1.105110484915131E4,2.60255227778904E4,6.15046624979402E4},
            {1.E0,-2.272727272727273E0,-2.37603305785124E-1,-1.802513164271241E-1,-1.682849538309255E-1,-1.613619184775872E-1,-1.298822235736018E-1,-1.759441664142186E-2,3.028436684608788E-1,1.122712141748854E0,3.10279935389848E0,7.73074469325153E0,1.833824084416299E1,4.236270770866048E1,9.63764788749243E1,2.172754171609312E2,4.87189754885665E2,1.089000363550062E3,2.430198828860298E3,5.419556639479847E3,1.208590070815909E4},
            {1.E0,-2.142857142857143E0,-2.563168124392614E-1,-2.205741294662577E-1,-2.424630041843108E-1,-2.969027491608954E-1,-3.809202669815479E-1,-4.906912495150735E-1,-6.047296073662444E-1,-6.487800884939942E-1,-4.129377968327216E-1,6.421906445325147E-1,3.831516797471773E0,1.225888639826512E1,3.309842031896443E1,8.26954513045274E1,1.979150844681963E2,4.612973138333094E2,1.056663465928497E3,2.39179045209901E3,5.368653409562131E3},
            {1.E0,-2.058823529411764E0,-2.790822211237436E-1,-2.568484560648208E-1,-2.996334177478526E-1,-3.905073767312549E-1,-5.398258122781102E-1,-7.68993911375251E-1,-1.105510203236712E0,-1.571749425128604E0,-2.15115863492876E0,-2.6963897980448E0,-2.697241666153191E0,-7.20198770964532E-1,6.906508426453192E0,2.911764338655729E1,8.69718487073127E1,2.290550508931911E2,5.657983946805931E2,1.345492275479593E3,3.121904698118087E3}
    };

    double B0vec[4][21] = {
        {0.E0,1.25E0,6.101190476190476E-1,1.343799603174603E0,3.148731480985945E0,7.60149762571432E0,1.866099839396991E1,4.628072776585462E1,1.155436928524777E2,2.897822768986019E2,7.291607564729621E2,1.839266832945214E3,4.64834472718537E3,1.176575063447987E4,2.981889604817649E4,7.565338752646161E4,1.921169917668302E5,4.882636189032636E5,1.24181066494045E6,3.160369061960046E6,8.04778361786385E6},
        {0.E0,1.136363636363636E0,5.165289256198347E-1,1.045402668956388E0,2.256683542331844E0,5.025062207687041E0,1.13858186175693E1,2.607278078227637E1,6.011794656455017E1,1.392768189166746E2,3.237690499876303E2,7.545745769118102E2,1.762099160553777E3,4.121423314887733E3,9.65227172789829E3,2.263012344112018E4,5.310696921431735E4,1.247300902004057E5,2.931603799361205E5,6.89479019036064E5,1.622527605838636E6},
        {0.E0,1.071428571428571E0,4.78620019436346E-1,9.2910592808552E-1,1.931671842098301E0,4.149921034184404E0,9.07979353693079E0,2.008794250861944E1,4.476468811835251E1,1.002528688631044E2,2.253279372639919E2,5.07807878937317E2,1.146797956130444E3,2.594145215927001E3,5.876114037008708E3,1.33253333273484E4,3.024719742040717E4,6.871562176194833E4,1.56223115468985E5,3.554018253662073E5,8.09003221387733E5},
        {0.E0,1.029411764705882E0,4.601252265612128E-1,8.71548596370498E-1,1.774820062211321E0,3.740109527504812E0,8.0322892879641E0,1.744970549750112E1,3.819353840682767E1,8.40297172619578E1,1.85563417174861E2,4.109255211646338E2,9.1195108745676E2,2.027339394635631E3,4.513259390691879E3,1.005915561317475E4,2.24421017322789E4,5.011148579836656E4,1.119789781510648E5,2.503942065581169E5,5.60235618548742E5}
    };

    double BPvec[4][21] = {
        {0.E0,2.857142857142857E-1,1.746031746031746E-1,1.755387469673184E-1,2.348816318741131E-1,3.827774251096715E-1,7.166742295365317E-1,1.472613606068099E0,3.209178187322788E0,7.247518561156945E0,1.671777375036747E1,3.904744810292436E1,9.18826051527924E1,2.171887376445869E2,5.148602344055422E2,1.222904984207168E3,2.908943991600574E3,6.928061999164432E3,1.651874642508249E4,3.942939588009119E4,9.4220921743958E4},
        {0.E0,3.376623376623376E-1,2.215663124754034E-1,2.463407866863915E-1,3.539399107941049E-1,5.865697013737726E-1,1.059559806171203E0,2.022255514144411E0,4.003992222553133E0,8.1315924305416E0,1.681616908122592E1,3.524227182699485E1,7.460638195578142E1,1.591798215290681E2,3.417527468123844E2,7.374860234797824E2,1.598277983141808E3,3.476478542819674E3,7.586010189144991E3,1.660042611347586E4,3.641973556730778E4},
        {0.E0,3.673469387755102E-1,2.413346290897311E-1,2.717120724617601E-1,3.916182747302613E-1,6.436151049336462E-1,1.142858650431224E0,2.131756682526903E0,4.11034349932089E0,8.11237032057705E0,1.628566071629319E1,3.311456342581162E1,6.800251513036537E1,1.407434049012024E2,2.931431113069098E2,6.137628726378354E2,1.290715076031626E3,2.724542806233957E3,5.770015082313769E3,1.22549822441903E4,2.60956143923575E4},
        {0.E0,3.865546218487395E-1,2.513868292415005E-1,2.833307310874116E-1,4.0765827454866E-1,6.661154576469265E-1,1.172480072848042E0,2.163706048290626E0,4.122558903259741E0,8.0343857345061E0,1.592000900042028E1,3.194366786778198E1,6.472307827452113E1,1.321590876893955E2,2.715583120908036E2,5.608978354205836E2,1.163589229872191E3,2.422891562810768E3,5.061394784874486E3,1.060320381326544E4,2.226883445365348E4}
    };

    double muvec[4][21] = {
        {0.E0,1.428571428571428E-1,-1.26984126984127E-1,-6.461157889729319E-2,-5.230848238367035E-2,-4.673610331434102E-2,-3.110947191622746E-2,2.36128913122628E-2,1.880830089424192E-1,6.381244932704147E-1,1.807090182073464E0,4.753126705706061E0,1.204318014105144E1,2.98779372479273E1,7.319613322370708E1,1.779337240059919E2},
        {0.E0,1.688311688311688E-1,-1.424635970090516E-1,-6.832901633803212E-2,-5.394856259885098E-2,-4.9647721581083E-2,-4.203668829393262E-2,-1.449503960194103E-2,6.920532538635236E-2,2.935499110059153E-1,8.54567891646738E-1,2.202398209591947E0,5.362260056626076E0,1.265562764328169E1,2.931812523584266E1,6.71256347117415E1},
        {0.E0,1.836734693877551E-1,-1.548428895367671E-1,-7.269595599458157E-2,-5.82178713057764E-2,-5.649900669934032E-2,-5.561726830984597E-2,-4.399277207641092E-2,2.451863128067071E-3,1.396616462516165E-1,4.969390380973512E-1,1.368763740446988E0,3.417875942171653E0,8.12297378639771E0,1.876291795656536E1,4.25759096964974E1},
        {0.E0,1.932773109243698E-1,-1.642225517658044E-1,-7.586635302607504E-2,-6.134645264610597E-2,-6.128326993440134E-2,-6.436839348920119E-2,-6.148098497390477E-2,-3.425852273669061E-2,6.035190794815187E-2,3.226200004342261E-1,9.81600406328572E-1,2.552515012378413E0,6.181353603831885E0,1.439656912812281E1,3.274404674570039E1}
    };
};


#endif //HTMAG_TVII_O11_SERIES_HPP
